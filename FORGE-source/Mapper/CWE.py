from typing import List
from pydantic import BaseModel
import json


class CWE:
    def __init__(self, ID: int, Name: str, Description: str, Abstraction: str):
        self.ID = ID
        self.Name = Name
        self.Description = Description
        self.Abstraction = Abstraction
        self.Peer: List["CWE"] = []
        self.Parent: List["CWE"] = []
        self.Child: List["CWE"] = []

    def add_child(self, child_cwe: "CWE"):
        self.Child.append(child_cwe)
        child_cwe.Parent.append(self)

    # 序列化方法


EXCLUDE_CWE = [
    "CWE-6",
    "CWE-7",
    "CWE-8",
    "CWE-9",
    "CWE-11",
    "CWE-12",
    "CWE-13",
    "CWE-1037",
    "CWE-1039",
    "CWE-1042",
    "CWE-1058",
    "CWE-552",
    "CWE-554",
    "CWE-555",
    "CWE-556",
    "CWE-558",
    "CWE-1073",
    "CWE-59",
    "CWE-1089",
    "CWE-66",
    "CWE-579",
    "CWE-577",
    "CWE-581",
    "CWE-578",
    "CWE-587",
    "CWE-588",
    "CWE-79",
    "CWE-110",
    "CWE-1105",
    "CWE-594",
    "CWE-86",
    "CWE-600",
    "CWE-601",
    "CWE-602",
    "CWE-91",
    "CWE-93",
    "CWE-608",
    "CWE-98",
    "CWE-611",
    "CWE-102",
    "CWE-103",
    "CWE-104",
    "CWE-105",
    "CWE-106",
    "CWE-107",
    "CWE-108",
    "CWE-109",
    "CWE-622",
    "CWE-113",
    "CWE-118",
    "CWE-639",
    "CWE-131",
    "CWE-647",
    "CWE-650",
    "CWE-653",
    "CWE-1174",
    "CWE-1191",
    "CWE-692",
    "CWE-696",
    "CWE-1223",
    "CWE-1224",
    "CWE-1231",
    "CWE-1232",
    "CWE-1233",
    "CWE-1234",
    "CWE-1236",
    "CWE-1242",
    "CWE-1245",
    "CWE-1248",
    "CWE-1250",
    "CWE-1220",
    "CWE-1252",
    "CWE-1253",
    "CWE-1256",
    "CWE-1257",
    "CWE-1259",
    "CWE-1260",
    "CWE-1262",
    "CWE-1263",
    "CWE-1268",
    "CWE-243",
    "CWE-245",
    "CWE-246",
    "CWE-1269",
    "CWE-1274",
    "CWE-1275",
    "CWE-1276",
    "CWE-1277",
    "CWE-1278",
    "CWE-1279",
    "CWE-1281",
    "CWE-1290",
    "CWE-1291",
    "CWE-1292",
    "CWE-1294",
    "CWE-1296",
    "CWE-1297",
    "CWE-1298",
    "CWE-784",
    "CWE-1304",
    "CWE-1310",
    "CWE-1311",
    "CWE-1312",
    "CWE-1313",
    "CWE-1315",
    "CWE-1316",
    "CWE-1317",
    "CWE-804",
    "CWE-1318",
    "CWE-1320",
    "CWE-1319",
    "CWE-1322",
    "CWE-1323",
    "CWE-1326",
    "CWE-1334",
    "CWE-1338",
    "CWE-1341",
    "CWE-333",
    "CWE-350",
    "CWE-1384",
    "CWE-364",
    "CWE-367",
    "CWE-382",
    "CWE-383",
    "CWE-395",
    "CWE-926",
    "CWE-939",
    "CWE-942",
    "CWE-943",
    "CWE-441",
    "CWE-444",
    "CWE-468",
    "CWE-469",
    "CWE-470",
    "CWE-471",
    "CWE-476",
    "CWE-479",
    "CWE-484",
    "CWE-489",
    "CWE-1004",
    "CWE-1022",
]
