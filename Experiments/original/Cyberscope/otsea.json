{"path": "./Audit_Reports_2024/Cyberscope/otsea.pdf", "project_info": {"url": "N/A", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-682"], "2": ["CWE-369"]}, "title": "PUO - Possible Unfulfilled Order", "description": "The contract exhibits a potential problem involving partially fillable orders that might remain unfulfilled due to division outcome of zero or insufficient available tokens.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-682"]}, "title": "WTCI - Whale Threshold Cap Inconsistency", "description": "In the contract's constructor, the `whaleThreshold` variable is initialized with a value that is significantly higher than the intended threshold of 1% of the total supply of the OTSea ERC20 token.", "severity": "Medium", "contract": "OTSea", "function": "constructor()", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-682"]}, "title": "CI - Calculation Inconsistency", "description": "The contract exhibits inconsistency in the calculation of the `requestedETH` variable between the requestOrder and updatePrice functions.", "severity": "N/A", "contract": "OTSea", "function": ["requestOrder", "updatePrice"], "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-682"], "2": ["CWE-369"]}, "title": "PZP - Possible Zero Price", "description": "The contract calculates the `pricePerToken` based on the `requestedETH` value and the `formattedTransferredTokenAmount`. However, if the `formattedTransferredTokenAmount` is greater than the requestedETH value, the division operation will result in zero. This can lead to division by zero errors when a user tries to fulfill an order, potentially causing issues with order fulfillment.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "GO - Gas Optimization", "description": "Gas optimization refers to the process of reducing the amount of gas required to execute a transaction. In the `requestOrder` function, the contract generates a unique order identifier using both the 'OTSea' string and a nonce. However, since the hashed value is only used as an identifier, the contract can optimize gas usage by using only the nonce as the identifier, eliminating the need to generate a hash.", "severity": "N/A", "contract": "N/A", "function": "requestOrder()", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-682"]}, "title": "OO - Operator Optimization", "description": "Optimize condition checks on unsigned integer variables by replacing '>' operator with '!=' operator.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-710"], "2": ["CWE-1120"], "3": ["CWE-1060"]}, "title": "VTO - Variable Type Optimization", "description": "The contract declares certain variables as uint256, even though their maximum value is capped at a much lower amount than the `type(uint256).max`. These variables can be more efficiently stored with smaller integer types to save storage space and reduce gas consumption.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "MU - Modifiers Usage", "description": "The contract is using repetitive statements on some methods to validate preconditions instead of using modifiers which can reduce code duplication and improve readability.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "MEE - Missing Events Emission", "description": "The contract performs actions and state mutations from external methods that do not result in the emission of events.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "PTRP - Potential Transfer Revert Propagation", "description": "The contract sends funds to certain wallets as part of the order settling flow. These addresses can either be a wallet address or a contract. If the address belongs to a contract then it may revert from incoming payment. As a result, the error will propagate to the contract and revert the transaction.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 10, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "RSW - Redundant Storage Writes", "description": "The contract modifies its state even when the provided value is the zero address and performs redundant storage writes when the current value matches the provided argument.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 11, "category": {"1": ["CWE-664"], "2": ["CWE-665"], "3": ["CWE-908"], "4": ["CWE-457"]}, "title": "IDI - Immutable Declaration Improvement", "description": "The contract declares state variables that their value is initialized once in the constructor and are not modified afterwards.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 12, "category": {"1": ["CWE-710"]}, "title": "L04 - Conformance to Solidity Naming Conventions", "description": "The code does not adhere to the Solidity style guide, which can affect readability and maintainability.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 13, "category": {"1": ["CWE-697"]}, "title": "L11 - Unnecessary Boolean equality", "description": "Boolean equality is unnecessary when comparing two boolean values because a boolean value is either true or false.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 14, "category": {"1": ["CWE-682"], "2": ["CWE-369"]}, "title": "L13 - Divide before Multiply Operation", "description": "Performing divisions before multiplications may cause loss of precision.", "severity": "Critical", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 15, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "L16 - Validate Variable Setters", "description": "The contract performs operations on variables configured by user-supplied input without proper checks for zero values, leading to potential problems during execution.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 16, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-394"]}, "title": "L19 - Stable Compiler Version", "description": "The `^` symbol indicates that any version of Solidity that is compatible with the specified version (i.e., any version that is a higher minor or patch version) can be used to compile the contract. The version lock is a mechanism that allows the author to specify a minimum version of the Solidity compiler that must be used to compile the contract code.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}]}