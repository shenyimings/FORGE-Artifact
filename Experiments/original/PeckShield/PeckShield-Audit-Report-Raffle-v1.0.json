{
    "path": "./Audit_Reports_2024/PeckShield/PeckShield-Audit-Report-Raffle-v1.0.pdf",
    "project_info": {
        "url": "https://github.com/LooksRare/contracts-raffle/tree/d6c377d",
        "commit_hash": "d6c377d",
        "address": "N/A",
        "is_exists": true
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-269"
                ],
                "3": [
                    "CWE-266"
                ]
            },
            "title": "Trust Issue of Admin Keys",
            "description": "In the `Raffle` protocol, there is a privileged `owner` account that plays a critical role in governing and regulating the protocol-wide operations.",
            "severity": "Low",
            "contract": "Raffle",
            "function": [
                "setProtocolFeeRecipient",
                "setProtocolFeeBp",
                "updateCurrenciesStatus"
            ],
            "lineNumber": "51-60,65"
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-662"
                ],
                "3": [
                    "CWE-820"
                ],
                "4": [
                    "CWE-567"
                ]
            },
            "title": "Weaknesses in Time and State Management",
            "description": "Improper management of time and state in an environment that supports simultaneous or near-simultaneous computation by multiple systems, processes, or threads.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-393"
                ]
            },
            "title": "Error Conditions, Return Values, Status Codes",
            "description": "Weaknesses in this category include weaknesses that occur if a function does not generate the correct return/status code, or if the application does not handle all possible return/status codes that could be generated by a function.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-400"
                ],
                "3": [
                    "CWE-770"
                ]
            },
            "title": "Resource Management",
            "description": "Weaknesses in this category are related to improper management of system resources.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-841"
                ]
            },
            "title": "Behavioral Issues",
            "description": "Weaknesses in this category are related to unexpected behaviors from code that an application uses.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Business Logics",
            "description": "Manually review business logic, examine system operations, and place DeFi-related aspects under scrutiny to uncover possible pitfalls and/or bugs.",
            "severity": "N/A",
            "contract": "Raffle",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-665"
                ],
                "3": [
                    "CWE-909"
                ],
                "4": [
                    "CWE-456"
                ]
            },
            "title": "Initialization and Cleanup",
            "description": "N/A",
            "severity": "N/A",
            "contract": "Raffle",
            "function": "_cancel()",
            "lineNumber": "529-538"
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-233"
                ]
            },
            "title": "Arguments and Parameters",
            "description": "The function _cancel() does not validate its arguments and parameters properly.",
            "severity": "Medium",
            "contract": "Raffle",
            "function": "_cancel(raffleId, raffle, shouldWithdrawPrizes)",
            "lineNumber": "529-533"
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Expression Issues",
            "description": "Potential precision loss due to incorrect order of operations in arithmetic expressions.",
            "severity": "Medium",
            "contract": "Raffle",
            "function": "_cancel() and depositPrizes()",
            "lineNumber": "537, 246"
        }
    ]
}