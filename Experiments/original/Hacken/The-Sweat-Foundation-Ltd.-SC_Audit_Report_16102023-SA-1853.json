{"path": "./Audit_Reports_2024/Hacken/The-Sweat-Foundation-Ltd.-SC_Audit_Report_16102023-SA-1853.pdf", "project_info": {"url": "https://github.com/sweatco/sweat-jar", "commit_hash": "ea17a632de99ff78a33368401cdcdf2e74792896", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "C01. Double Public Key Signing Function Oracle Attack On ed25519-dalek", "description": "An adversary could use the signing function as an oracle that allows arbitrary public keys as input can obtain two signatures for the same message sharing the same R and only differ on the S part, enabling private key extraction attacks.", "severity": "Critical", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "H01. Requirements Violation", "description": "The contract does not meet the specified requirements.", "severity": "Unknown", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-862"]}, "title": "H02. Access Control Violation", "description": "N/A", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-682"]}, "title": "H03. Inefficient Gas Model", "description": "Inefficient gas model in ft_transfer() function of contract ft_interface.rs", "severity": "High", "contract": "ft_interface.rs", "function": "Promise::ft_transfer()", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-252"]}, "title": "M01. Missing Check", "description": "N/A", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-703"], "2": ["CWE-228"], "3": ["CWE-166"]}, "title": "M02. Missing Annotation", "description": "Missing annotation in smart contract code can lead to misunderstandings and make it difficult for developers to understand the intended behavior of the code.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "M03. Undocumented Behavior", "description": "N/A", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "M04. Reliance On Off-Chain Data", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "M05. Data Inconsistency Due to Edge Case", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "M06. State Corruption Due to Edge Case", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 10, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "L01. Variable Is Not Limited", "description": "N/A", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 11, "category": {"1": ["CWE-682"], "2": ["CWE-1339"]}, "title": "L02. Value Rounding", "description": "The interest is calculated using minutes which reduces the precision of the calculation.", "severity": "Low", "contract": "N/A", "function": "get_interest()", "lineNumber": "N/A"}, {"id": 12, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "L03. Jars Migration Functionality Is Not Limited in Time", "description": "Jars migration functionality is designed to be temporary but lacks time limits.", "severity": "Low", "contract": "ft_receiver/migration/api", "function": "migrate_jars()", "lineNumber": "N/A"}, {"id": 13, "category": {"1": ["CWE-664"], "2": ["CWE-400"], "3": ["CWE-770"], "4": ["CWE-1325"]}, "title": "L04. Redundant Allocations", "description": "N/A", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 14, "category": {"1": ["CWE-664"], "2": ["CWE-400"], "3": ["CWE-1235"]}, "title": "L05. Inefficient Gas Model and Inconsistency", "description": "Inefficient gas model and inconsistency in the contract.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 15, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "I01. Redundant Configuration", "description": "Unnecessary usage of #[cfg_attr(\u2026) macro as the compiler automatically removes unused code from the binary during deployment.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 16, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "I02. Idiomatic Map Usage", "description": "The map is used in an ungraceful way. When a single element is being added, the whole map is cloned, modified, then saved back to storage.", "severity": "Informational", "contract": "N/A", "function": "save_jar(), migrate_jars()", "lineNumber": "./contract/src/internal.rs: N/A, ./contract/migration/api.rs: N/A"}, {"id": 17, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "I03. Redundant Clones", "description": "Copying data wastes compute power and increases Gas fees.", "severity": "Informational", "contract": "N/A", "function": ["ft_on_transfer()", "get_product()", "save_jar()", "allows_ top_up()", "allows_restaking()", "register_product()"], "lineNumber": "N/A"}, {"id": 18, "category": {"1": ["CWE-710"], "2": ["CWE-1061"]}, "title": "I04. Code Readability", "description": "Code readability issue found in the smart contract.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 19, "category": {"1": ["CWE-682"]}, "title": "I05. Inefficient Gas Model", "description": "Inefficient gas model in Promise::ft_transfer() function of ft_interface.rs contract.", "severity": "Informational", "contract": "ft_interface.rs", "function": "Promise::ft_transfer()", "lineNumber": "N/A"}, {"id": 20, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-394"]}, "title": "I06. Redundant Checks", "description": "N/A", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 21, "category": {"1": ["CWE-682"]}, "title": "I07. Inconsistent Interest Calculation", "description": "In claim_jars(), jars get locked regardless of whether there is interest to claim from them or not, leading to stuck locked state if no interest to claim.", "severity": "High", "contract": "claim/api.rs", "function": "claim_jars()", "lineNumber": "N/A"}, {"id": 22, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "I08. Redundant Operations", "description": "Redundant copying of jars and manual swap_remove operation in restake function.", "severity": "N/A", "contract": "jar", "function": "restake()", "lineNumber": "N/A"}, {"id": 23, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "I09. Inefficient Search", "description": "N/A", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 24, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "M03. Undocumented Behavior", "description": "N/A", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 25, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "M04. Reliance On Off-Chain Data", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}]}