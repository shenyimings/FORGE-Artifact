{"path": "./Audit_Reports_2024/Hacken/GemDrop_SC-Audit-Report_10.10.23_SA-1897-1.pdf", "project_info": {"url": "https://gitlab.com/block-labs/gemdrop/smart-contracts/-/blob/develop/contracts", "commit_hash": "44cb86512058cdb4df5888589aa4f5a6afac6c3d", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "I06. Wrongly Generated Addresses In Fee Array Can Block Deposit Functionalities Or Lock Tokens", "description": "The fee receiver addresses generated by the backend system are not validated within the smart contract, which can lead to incorrect addresses blocking deposit functionalities or locking tokens.", "severity": "Critical", "contract": "Depositor", "function": ["deposit()", "depositNative()"], "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-693"], "2": ["CWE-807"], "3": ["CWE-302"]}, "title": "C01. Signature Replay Attack Can Led to Unlimited Deposits", "description": "The absence of a nonce parameter in the signature and failure to track it effectively allows users to exploit the same signature multiple times within a specified deadline, leading to unlimited deposits.", "severity": "Critical", "contract": "Depositor", "function": "deposit(), depositNative()", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "L01. Usage Of Built-in Transfer", "description": "The built-in transfer() and send() functions process a hard-coded amount of Gas. In case the receiver is a contract with receive or fallback function, the transfer may fail due to the \u201cout of Gas\u201d exception.", "severity": "Low", "contract": "Depositor", "function": "depositNative(), withdrawNative()", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-693"], "2": ["CWE-807"], "3": ["CWE-302"]}, "title": "L02. Missing ChainId Value Stored", "description": "This omission could potentially result in a scenario where a signature remains valid on both forked chains.", "severity": "Low", "contract": "Depositor", "function": "_getDepositHash();", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-682"]}, "title": "I01. Floating Pragma", "description": "The project uses floating pragmas ^0.8.0 which may result in contracts being deployed using the wrong pragma version, different from the one they were tested with.", "severity": "Informational", "contract": "Depositor", "function": "N/A", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-710"], "2": ["CWE-1061"], "3": ["CWE-766"]}, "title": "Variables That Should Be Declared Constant", "description": "State variables DEPOSIT_FUNCTION_HASH and DEPOSIT_NATIVE_FUNCTION_HASH do not change their value and should be declared constant to save Gas.", "severity": "Medium", "contract": "Depositor", "function": "N/A", "lineNumber": "./contracts/Depositor.sol: DEPOSIT_FUNCTION_HASH, DEPOSIT_NATIVE_FUNCTION_HASH;"}, {"id": 6, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "I03. Redundant Import Of IERC20 Interface", "description": "The IERC20 interface import is redundant in the Depositor contract as it's already imported within SafeERC20 library, which can result in unnecessary gas consumption during deployment and impact code quality.", "severity": "Informational", "contract": "Depositor", "function": "N/A", "lineNumber": "./contracts/Depositor.sol: *"}, {"id": 7, "category": {"1": ["CWE-682"], "2": ["CWE-369"]}, "title": "I04. Zero Valued Transactions", "description": "The functions deposit() and depositNative() can execute a zero-valued transaction if fee.amount is 0, leading to a transaction with zero value to be sent.", "severity": "Informational", "contract": "Depositor", "function": ["deposit()", "depositNative()"], "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "I05. Missing Event For Critical Value Updation", "description": "The function setBackendSigner() does not emit events when important values change.", "severity": "Informational", "contract": "N/A", "function": "setBackendSigner()", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-710"], "2": ["CWE-1120"], "3": ["CWE-1060"]}, "title": "I07. Use Custom Errors Instead Of Error Strings To Save Gas", "description": "Using custom errors instead of error strings can save approximately 50 Gas each time they are hit because they avoid the need to allocate and store revert strings.", "severity": "N/A", "contract": "./contracts/Depositor.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 10, "category": {"1": ["CWE-284"], "2": ["CWE-287"]}, "title": "I08. Zero Address Backend Signer Can Disturb Deposit Flow", "description": "Zero address backend signer can disturb deposit flow and renders the system incapable of signing and verifying messages, leading to users receiving an Incorrect signature error.", "severity": "Informational", "contract": "Depositor", "function": "setBackendSigner()", "lineNumber": "N/A"}]}