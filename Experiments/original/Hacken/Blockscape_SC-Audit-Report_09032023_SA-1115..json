{"path": "./Audit_Reports_2024/Hacken/Blockscape_SC-Audit-Report_09032023_SA-1115..pdf", "project_info": {"url": "https://github.com/BlockscapeNetwork/rocketscape/tree/main/src", "commit_hash": "73fe19ee5b8c62af2c04b22ee7a6b2972ce1aa2e", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "Flashloan Attack", "description": "When working with exchange rates, they should be received from a trusted source and not be vulnerable to short-term rate changes that can be achieved by using flash loans. Oracles should be used.", "severity": "Custom", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-863"]}, "title": "Token Supply Manipulation", "description": "Tokens can be minted only according to rules specified in a whitepaper or any other documentation provided by the customer.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "Gas Limit and Loops", "description": "Transaction execution costs should not depend dramatically on the amount of data stored on the contract. There should not be any cases when execution fails due to the block Gas limit.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-710"]}, "title": "Style Guide Violation - Constant Naming", "description": "The provided project violates the official guidelines: constant names should be in all-uppercase with underscore as the word separator.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Requirements Compliance", "description": "The smart contract does not fully comply with the specified requirements.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-435"], "2": ["CWE-439"]}, "title": "Environment Consistency", "description": "Inconsistent environment configuration", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "Secure Oracles Usage", "description": "The code should have the ability to pause specific data feeds that it relies on. This should be done to protect a contract from compromised oracles.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Tests Coverage", "description": "Code coverage of the project is 59.68% (branch coverage). Basic user interactions are covered with tests, but negative cases coverage is missing and interactions with several users are not tested thoroughly.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-710"], "2": ["CWE-1068"]}, "title": "C01. Requirements Violation", "description": "N/A", "severity": "Critical", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"]}, "title": "H01. Highly Permissive Role Access", "description": "State variables visibility is not specified, which can lead to incorrect assumptions about who can access the variable.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 10, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"]}, "title": "H02. Highly Permissive Role Access", "description": "The owner of the contract can set a withdrawal fee at any value and at any time, which can mislead users over expected withdrawal of funds and cause withdrawal amount manipulation.", "severity": "Medium", "contract": "BlockscapeValidatorNFT.sol", "function": "setWithdrawFee();", "lineNumber": "N/A"}, {"id": 11, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "M01. Wrong Data Type", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 12, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "M02. Misleading Documentation", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 13, "category": {"1": ["CWE-703"]}, "title": "M03. Requirements Violation", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 14, "category": {"1": ["CWE-664"], "2": ["CWE-221"], "3": ["CWE-223"]}, "title": "M04. Writing Blank Data", "description": "InstitutionName and institutionVerified are never accessed or written.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 15, "category": {"1": ["CWE-710"], "2": ["CWE-1061"]}, "title": "M05. Bad Practice", "description": "N/A", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 16, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-394"]}, "title": "M06. Using transfer() to Send Native Tokens", "description": "Using withdraw() and send() functions to send native tokens is considered a bad practice since the Istanbul fork because they rely on Gas limitation and can give unclear errors in case of insufficient funds to send.", "severity": "Medium", "contract": "./src/BlockscapeValidatorNFT.sol", "function": "withdraw();", "lineNumber": "N/A"}, {"id": 17, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "L01. Floating Pragma", "description": "Using a floating pragma version can lead to unexpected behavior and potential security vulnerabilities.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 18, "category": {"1": ["CWE-710"], "2": ["CWE-1076"], "3": ["CWE-1078"], "4": ["CWE-1099"]}, "title": "L02. Style Guide Violation - Constant Naming", "description": "The provided project violates the official guidelines: constant names should be in all-uppercase with underscore as the word separator.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 19, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "L03. Unused Variables", "description": "Unused variables should be removed from the contracts as they can cause an increase in computations and decrease readability.", "severity": "Low", "contract": "BlockscapeETHStakeNFT.sol, BlockscapeValidatorNFT.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 20, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"], "4": ["CWE-766"]}, "title": "L04. State Variables Default Visibility", "description": "State variables allowPubDeposit, tokenID, rocketNodeStakingAddress, rocketNodeStaking, tokenIDtoMetadata, and tokenIDtoValidator have default visibility which can lead to incorrect assumptions about who can access the variable.", "severity": "N/A", "contract": "BlockscapeETHStakeNFT.sol, BlockscapeValidatorNFT.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 21, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "L05. Redundant Zero Value Initialization", "description": "Variables are initialized with their default data type zero value, which adds no value and increases Gas cost unnecessarily.", "severity": "Low", "contract": "BlockscapeETHStakeNFT.sol; BlockscapeValidatorNFT.sol;", "function": "N/A", "lineNumber": "N/A"}, {"id": 22, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1288"]}, "title": "L06. Redundant State Variable", "description": "The state variable rocketNodeStakingAddress is never used directly in the code except for assignment to another state variable rocketNodeStaking.", "severity": "Low", "contract": "BlockscapeETHStakeNFT.sol, BlockscapeValidatorNFT.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 23, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1288"]}, "title": "L07. Unused Fields in Struct", "description": "This increases the Gas cost because of redundant storage writing and might be a sign of unfinished code.", "severity": "Low", "contract": "BlockscapeETHStakeNFT.sol, BlockscapeValidatorNFT.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 24, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"], "4": ["CWE-766"]}, "title": "L07. State Variables Can Be Declared Immutable", "description": "Specify variables as public, internal, or private and explicitly define visibility for all state variables.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 25, "category": {"1": ["CWE-664"], "2": ["CWE-665"], "3": ["CWE-909"]}, "title": "L08. Unindexed Events", "description": "N/A", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 26, "category": {"1": ["CWE-707"], "2": ["CWE-228"], "3": ["CWE-237"], "4": ["CWE-238"]}, "title": "L09. Code Duplication", "description": "Many functions, events and state variables are duplicated in both Smart Contracts, among some of them: name, symbol, tokenID, userRequestFullWithdraw() and others.", "severity": "Low", "contract": "BlockscapeETHStakeNFT.sol; BlockscapeValidatorNFT.sol", "function": "N/A", "lineNumber": "N/A"}, {"id": 27, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-394"]}, "title": "L10. Redundant Usage of Reentrancy Guard", "description": "N/A", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 28, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-252"]}, "title": "L11. Unused Function Parameter", "description": "The function userRequestWithdraw() declares the _amount return parameter, however it is never returned or used.", "severity": "Low", "contract": "BlockscapeValidatorNFT", "function": "userRequestWithdraw()", "lineNumber": "N/A"}, {"id": 29, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "L12. Missing Events", "description": "Events for critical state changes should be emitted for tracking things off-chain.", "severity": "Medium", "contract": ["BlockscapeValidatorNFT", "BlockscapeETHStakeNFT"], "function": ["setWithdrawFee()", "closeValidatorNFT()", "updateValidator()", "openValidatorNFT()"], "lineNumber": "N/A"}, {"id": 30, "category": {"1": ["CWE-682"], "2": ["CWE-191"]}, "title": "Potential Underflow Possibility", "description": "The arithmetic equation nodeRPLStake - minimumReqRPL might throw an underflow error if the minimumReqRPL is greater than nodeRPLStake.", "severity": "High", "contract": "BlockscapeValidatorNFT", "function": "hasNodeEnoughRPLStake()", "lineNumber": "N/A"}, {"id": 31, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "L14. Misleading Documentation", "description": "Misleading documentation was found in the contract.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 32, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "L15. Redundant External Call", "description": "The functions contain calls to other functions in the same contract through the keyword \u201cthis\u201d. This turns a cheap code jump into an external call, increasing Gas usage.", "severity": "Low", "contract": "BlockscapeValidatorNFT, BlockscapeETHStakeNFT", "function": "totalSupply()", "lineNumber": "N/A"}, {"id": 33, "category": {"1": ["CWE-710"], "2": ["CWE-1164"]}, "title": "Commented code parts", "description": "N/A", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 34, "category": {"1": ["CWE-710"], "2": ["CWE-1059"]}, "title": "L17. Typos in Documentation", "description": "Typos are present in the documentation.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 35, "category": {"1": ["CWE-710"]}, "title": "L18. Style Guide Violation", "description": "Style guide violation.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 36, "category": {"1": ["CWE-710"], "2": ["CWE-1059"]}, "title": "Error in Documentation", "description": "N/A", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 37, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "L20. Redundant Use of Assembly", "description": "Replace assembly blocks with Solidity, provide error data in the revert clauses.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 38, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-394"]}, "title": "L21. Empty Revert Messages", "description": "Replace assembly blocks with Solidity and provide error data in the revert clauses.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 39, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1288"]}, "title": "L22. Unused Event", "description": "Unused events were found in the contract.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 40, "category": {"1": ["CWE-682"]}, "title": "L23. Storage Abuse", "description": "The function updateValidator() always calls openValidatorNFT() in case of a happy path, leading to redundant duplicated check of RPL stake and unnecessary expensive Gas consumption.", "severity": "Low", "contract": "BlockscapeValidatorNFT.sol", "function": "updateValidator()", "lineNumber": "N/A"}]}