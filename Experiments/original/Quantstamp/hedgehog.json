{
    "path": "./Audit_Reports_2024/Quantstamp/hedgehog.pdf",
    "project_info": {
        "url": "https://github.com/Hedgehog-Markets/Hedgehog/tree/53b3b1221f17eec232b138378a69112a38941c96",
        "commit_hash": "53b3b1221f17eec232b138378a69112a38941c96",
        "address": "N/A",
        "is_exists": false
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-241"
                ]
            },
            "title": "Fails with incorrect UserMarketInfo.",
            "description": "The contract fails when initialized with an invalid UserMarketInfo account.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Fails with incorrect UserROIInfo.",
            "description": "The contract fails to initialize a UserROIInfo account when provided with invalid seeds or other invalid constraints.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Fails with incorrect prediction",
            "description": "No description provided.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-241"
                ]
            },
            "title": "Fails when a token account with an invalid event set is used",
            "description": "The contract fails when a token account with an invalid event set is used.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-237"
                ],
                "4": [
                    "CWE-239"
                ]
            },
            "title": "Fails when an invalid Event is used",
            "description": "The contract fails when an invalid Event is used.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Fails when an invalid pool is used",
            "description": "The contract fails to handle an invalid pool, leading to potential security risks.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-229"
                ],
                "4": [
                    "CWE-232"
                ]
            },
            "title": "Fails when an invalid UserMarketInfo is used",
            "description": "The contract fails to handle invalid UserMarketInfo inputs.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-229"
                ],
                "4": [
                    "CWE-232"
                ]
            },
            "title": "Fails when an invalid UserROIInfo is used",
            "description": "The contract fails to handle invalid UserROIInfo inputs.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Fails to enter prediction when MarketStatus is not Open",
            "description": "The contract fails to enter a prediction when the market status is not open.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-193"
                ]
            },
            "title": "Fails to initialize an event with mismatching creator",
            "description": "The function fails to initialize an event when the creator does not match.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 10,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-666"
                ],
                "3": [
                    "CWE-672"
                ]
            },
            "title": "Fails to update mutable Market Ipfs resource with an invalid creator",
            "description": "The function fails to update a mutable Market Ipfs resource when provided with an invalid creator.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 11,
            "category": {
                "1": [
                    "CWE-664"
                ],
                "2": [
                    "CWE-666"
                ],
                "3": [
                    "CWE-672"
                ]
            },
            "title": "Fails to update mutable Market Ipfs resource with an invalid event",
            "description": "The contract fails to update a mutable Market Ipfs resource when provided with an invalid event.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 12,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Fails duplicate main market init calls",
            "description": "The contract fails when duplicate main market initialization calls are made.",
            "severity": "Low Risk",
            "contract": "N/A",
            "function": "init_market",
            "lineNumber": "N/A"
        },
        {
            "id": 13,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-229"
                ],
                "4": [
                    "CWE-232"
                ]
            },
            "title": "Fails initialization when using invalid seed indexes",
            "description": "The contract fails to initialize when provided with invalid seed indexes.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 14,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-287"
                ]
            },
            "title": "Fails when correct creator does not sign",
            "description": "The contract fails when the correct creator does not sign.",
            "severity": "N/A",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 15,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-237"
                ],
                "4": [
                    "CWE-238"
                ]
            },
            "title": "Fails when incorrect event_set is provided",
            "description": "The contract fails when an invalid event set is used.",
            "severity": "High",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 16,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-755"
                ]
            },
            "title": "Fails when incorrect mint is provided",
            "description": "The contract fails to handle an incorrect mint being provided.",
            "severity": "High Risk",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 17,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-346"
                ],
                "3": [
                    "CWE-940"
                ]
            },
            "title": "Address of the Parimutuel Program not Verified",
            "description": "In the lib.rs file (L2677), located in hh-paramitiuel module, the address of the parimutuel is not verified; thus an attacker can execute remote code.",
            "severity": "High Risk",
            "contract": "/hh-programs-anchor/hh-parimutuel/src/lib.rs",
            "function": "N/A",
            "lineNumber": "2677"
        },
        {
            "id": 18,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Overflow In The Find_User_Reward Function",
            "description": "The find_user_reward function calculates the reward user, but it compares two variables: FINAL_LEADERBOARD_LENGTH and ...",
            "severity": "Medium Risk",
            "contract": "/hh-programs-anchor/hh-parimutuel/src/lib.rs",
            "function": "find_user_reward",
            "lineNumber": "1722"
        },
        {
            "id": 19,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Overflow in the Output Msg",
            "description": "The addition operation using the + operator can cause an overflow.",
            "severity": "Medium Risk",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 20,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Overflow in the Output Reward Sources Variable",
            "description": "In the init_reward_info function, the vault.reward_sources is incremented by one using the + operator, which can cause an overflow.",
            "severity": "Medium Risk",
            "contract": "hh-vault",
            "function": "init_reward_info",
            "lineNumber": "L1038"
        },
        {
            "id": 21,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Overflow in the Sponsor_Token_Amount and Amount Variable",
            "description": "The state.sponsor_tokens_owned and state.amount variables are incremented using the + operator, which can cause an overflow. If one uses the debug build, it can cause a panic; however, in release build it will overflow silently.",
            "severity": "Medium Risk",
            "contract": "/hh-programs-anchor/hh-vault/src/lib.rs",
            "function": "handle_deposit",
            "lineNumber": "L2994 and 2995"
        },
        {
            "id": 22,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Overflow/Underflow In The Total Amount Deposited and Sponsored",
            "description": "In the deposit_to_vault/withdraw_from_vault function, the vault.total_amount_deposited and vault.total_amount_sponsored variables are incremented/decremented using the +/- operators, which can cause an overflow and underflow, respectively.",
            "severity": "Medium Risk",
            "contract": "N/A",
            "function": "deposit_to_vault/withdraw_from_vault",
            "lineNumber": "N/A"
        },
        {
            "id": 23,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Lack of Verification in the Market Expiry",
            "description": "The market can be initialized with an expiry_unix timestamp lower than the current time, harming the program's logic.",
            "severity": "Low Risk",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 24,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-193"
                ]
            },
            "title": "Lack of Verification in the LockUp Expiry",
            "description": "The lockup expiry timestamp is not verified to be greater than the current time, which can harm the logic of the program.",
            "severity": "Low Risk",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 25,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ],
                "3": [
                    "CWE-354"
                ]
            },
            "title": "Lack of Verification in the Amount and Pool ID",
            "description": "The add_user_and_deposit_full function takes two parameters, amount and pool_id, which are not verified; also, one can inject an ID of a non-existent pool.",
            "severity": "Low Risk",
            "contract": "apricot.rs",
            "function": "add_user_and_deposit_full",
            "lineNumber": "60, 61, 102, 103"
        },
        {
            "id": 26,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-193"
                ]
            },
            "title": "Unnecessary Verification on Expiry_Unix",
            "description": "Comparing market.expiry_unix against zero is unnecessary when verification can be performed using comparison between market.expiry_unix and the current time.",
            "severity": "Low Risk",
            "contract": "hh-parimutuel",
            "function": "N/A",
            "lineNumber": "364, 381"
        },
        {
            "id": 27,
            "category": {
                "1": [
                    "CWE-682"
                ],
                "2": [
                    "CWE-190"
                ]
            },
            "title": "Lack of Verifcation on the Amount Variable",
            "description": "N/A",
            "severity": "Low Risk",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 28,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1164"
                ]
            },
            "title": "Comments Left In the Code",
            "description": "Remove the commented out code as it has no purpose.",
            "severity": "Informational",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 29,
            "category": {
                "1": [
                    "CWE-710"
                ],
                "2": [
                    "CWE-1177"
                ]
            },
            "title": "Deprecated Functions Left In the Code",
            "description": "We found some functions marked as deprecated; if these functions are not used anymore, the team should consider removing them.",
            "severity": "Informational",
            "contract": "hh-vault",
            "function": "N/A",
            "lineNumber": "843, 919, 1315, 2538, 2562, 2777"
        }
    ]
}