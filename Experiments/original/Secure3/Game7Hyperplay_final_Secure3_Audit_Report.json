{"path": "./Audit_Reports_2024/Secure3/Game7Hyperplay_final_Secure3_Audit_Report.pdf", "project_info": {"url": "https://gitfront.io/r/user-3808373/2DuWU5ScT8f4/ achievo-contracts", "commit_hash": "9d3cc55398755a48bd85123b4af0e8412697e736f74e1b5cb32d3518a0dcfb9", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "There exists collisions for tokenId crafted with storeId and gameId", "description": "The tokenId generated by concatenating storeId and gameId can result in collisions, leading to incorrect information recorded in the contract.", "severity": "Critical", "contract": "GameSummary.sol", "function": "concat() and createCommonGameSummary()", "lineNumber": "64-71, 197-211"}, {"id": 1, "category": {"1": ["CWE-284"], "2": ["CWE-287"]}, "title": "Potential risk of using signature repeatedly", "description": "A malicious player can reuse a valid signature to update achievements for different games without any restrictions as long as the nonce remains constant.", "severity": "Critical", "contract": "GameSummary", "function": ["recoverAddress", "verifySignature", "updatePlayerAchievementsWithSignature", "mintGameSummaryWithSignature", "batchPlayerUpdateAchievementsWithSignature", "batchMintGameSummaryWithSignature"], "lineNumber": "110-124, 117-124, 187-195, 238-247, 261-272, 289-303"}, {"id": 2, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-863"]}, "title": "Potentially add achievements to the burned token", "description": "The burn function clears achievementsMinted but does not clear other information, allowing admins or users with signatures to add achievements to burned tokens.", "severity": "Medium", "contract": "GameSummary", "function": ["addPlayerAchievements", "burn"], "lineNumber": "167-177, 324-331"}, {"id": 3, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"]}, "title": "Inconsistent and Unrestricted Achievement Update", "description": "The addPlayerAchievements function does not have any restrictions on updating achievements, which can lead to inconsistent achievement updates.", "severity": "Medium", "contract": "GameSummary", "function": "addPlayerAchievements()", "lineNumber": "167-177"}, {"id": 4, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-862"]}, "title": "Achievement Update Vulnerability", "description": "The functions updatePlayerAchievementsWithSignature(), mintGameSummaryWithSignature(), batchPlayerUpdateAchievementWithSignature() and batchMintGameSummaryWithSignature() allow a player to add new achievements without any restrictions, as long as the nonce remains constant.", "severity": "Medium", "contract": "GameSummary.sol", "function": ["updatePlayerAchievementsWithSignature", "mintGameSummaryWithSignature", "batchPlayerUpdateAchievementWithSignature", "batchMintGameSummaryWithSignature"], "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "Unable to call safeTransferFrom() and safeBatchTransferFrom() again due to transferring token without fully updating playerGameData information", "description": "The functions safeTransferFrom() and safeBatchTransferFrom() do not update the playerGameData of the token for both from and to addresses, causing the to address to be unable to transfer the received token again.", "severity": "Medium", "contract": "GameSummary", "function": ["safeTransferFrom()", "safeBatchTransferFrom()"], "lineNumber": "305-309, 311-318"}, {"id": 6, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "Potential incorrect number of tokens burned due to the given amount via the parameter", "description": "The burn function allows burning a variable amount of tokens, but since minting always creates a single token, this can lead to errors if the amount is not 1. If the amount is over 1, the burn call will fail. If the amount is 0, the call will succeed but the token will still exist and the user's achievements information will be cleared.", "severity": "Medium", "contract": "GameSummary", "function": ["burn", "burnBatch"], "lineNumber": "324-331, 333-344"}, {"id": 7, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Lack of the exist check for the gameSummary in mintGameSummary()", "description": "The function `mintGameSummary()` is used to mint the token for the `gameSummary` which is created by the function `createCommonGameSummary()`. However, there is no logic to check whether the `gameSummary` exists for the token to mint.", "severity": "Low", "contract": "GameSummary", "function": "mintGameSummary()", "lineNumber": "L213-L226"}, {"id": 8, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "verifySignature(...) if statement can be simplified", "description": "The verifySignature method can be simplified by directly returning the value of the whitelistSigners mapping instead of using an if block.", "severity": "Low", "contract": "N/A", "function": "verifySignature", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-682"]}, "title": "Potential incorrect number of tokens burned due to the", "description": "The burn function allows burning a given amount of tokens, which may lead to incorrect token burning or clearing of user achievements information.", "severity": "Medium", "contract": "GameSummary", "function": ["burn", "burnBatch"], "lineNumber": ["324-331", "333-344"]}]}