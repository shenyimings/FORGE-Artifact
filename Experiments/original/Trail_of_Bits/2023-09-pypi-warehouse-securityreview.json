{"path": "./Audit_Reports_2024/Trail_of_Bits/2023-09-pypi-warehouse-securityreview.pdf", "project_info": {"url": "https://github.com/user/repo.git", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-707"], "2": ["CWE-74"], "3": ["CWE-94"]}, "title": "Unsafe input handling in \u201cCombine PRs\u201d workflow", "description": "Unsanitized user input is directly interpolated into code snippets in the \u201ccombine pull requests\u201d Github Actions workflow, which can allow an attacker with enough permissions to execute this workflow to perform arbitrary code execution in the context of the workflow job.", "severity": "Informational", "contract": "warehouse/.github/worksflows/combine-prs.yml", "function": "N/A", "lineNumber": "25\u201328"}, {"id": 1, "category": {"1": ["CWE-693"], "2": ["CWE-327"], "3": ["CWE-328"]}, "title": "Weak signatures used in AWS SNS verification", "description": "The Warehouse contract uses PKCS#1v1.5 with SHA-1 signature verification of SNS payloads which is vulnerable to certificate forgery, allowing an attacker to control Warehouse's SNS topic subscriptions and file false bounce/complaint notices against email addresses.", "severity": "High", "contract": "warehouse/warehouse/utils/sns.py", "function": "N/A", "lineNumber": "69-72"}, {"id": 2, "category": {"1": ["CWE-710"], "2": ["CWE-1101"]}, "title": "Vulnerable dependencies in Cabotage", "description": "Unused dependencies were identified in Cabotage's build and external dependencies, including amqp, asn1crypto, distlib, Babel, billard, blinker, cachetools, etc., which may increase the attack surface.", "severity": "N/A", "contract": "Cabotage", "function": "N/A", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "Lack of rate limiting on endpoints that send email", "description": "Warehouse sends notification emails when sensitive actions are performed by users without rate limits on certain routes, including manage.account, manage.account.totp-provision, and others.", "severity": "Low", "contract": "warehouse/warehouse/manage/__init__.py", "function": "N/A", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-697"]}, "title": "Account status information leak for frozen and disabled accounts", "description": "An attacker can determine a target's account status on PyPI without knowing their password or any other information by exploiting distinct error messages returned to the requesting client.", "severity": "Critical", "contract": "security_policy.py", "function": "N/A", "lineNumber": "59\u201378"}, {"id": 5, "category": {"1": ["CWE-691"], "2": ["CWE-362"]}, "title": "Potential race conditions in search locking", "description": "The SearchLock context manager does not handle Redis lock timeouts properly, allowing an attacker to trigger reindex or unindex tasks and cause stale or misleading information in the search index.", "severity": "Undetermined", "contract": "N/A", "function": "SearchLock", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-707"], "2": ["CWE-116"], "3": ["CWE-838"]}, "title": "Use of multiple distinct URL parsers", "description": "The use of multiple distinct URL parsers can lead to domain and path confusion, resulting in exploitable open redirects, requests to unintended domains or paths, and similar behavior.", "severity": "N/A", "contract": "warehouse", "function": "is_safe_url()", "lineNumber": "warehouse/warehouse/utils/http.py#22-53"}, {"id": 7, "category": {"1": ["CWE-693"], "2": ["CWE-358"]}, "title": "Overly permissive CSP headers on XML views", "description": "XML views allow arbitrary inline styles to be loaded due to a single 'unsafe-inline' rule for 'style-src', minimizing the risk of stylesheet injection.", "severity": "Informational", "contract": "warehouse/warehouse/sitemap/views.py", "function": "N/A", "lineNumber": "47-50"}, {"id": 8, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"]}, "title": "Missing Permissions-Policy", "description": "The PyPI.org website does not serve a 'Permissions-Policy' header, which can lead to security vulnerabilities.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-697"], "2": ["CWE-1024"]}, "title": "Domain separation in file digests", "description": "The finding highlights a potential issue where a user may still choose to upload a distribution whose MD5 conflicts with other (legitimate) distributions.", "severity": "Resolved", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 10, "category": {"1": ["CWE-664"], "2": ["CWE-666"], "3": ["CWE-672"]}, "title": "Object storage susceptible to TOC/TOU due to temporary files", "description": "Warehouse's use of named temporary files is susceptible to TOC/TOU attacks, allowing an attacker to rewrite file contents after validation but before storage, resulting in an inconsistent and potentially exploitable split state between the PyPI database and the artifacts being served to clients.", "severity": "Medium", "contract": "IGenericFileStorage", "function": "store()", "lineNumber": "21-52"}, {"id": 11, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "HTTP header is silently trusted if token mismatches", "description": "Warehouse uses a special header to determine if the request is coming from a trusted proxy. However, this does not account for the special case where the `` `X-Warehouse-Token`  header is present but its value does not match the shared secret.", "severity": "Informational", "contract": "warehouse/warehouse/utils/wsgi.py", "function": "__call__", "lineNumber": "N/A"}, {"id": 12, "category": {"1": ["CWE-710"], "2": ["CWE-477"]}, "title": "Bleach library is deprecated", "description": "The Bleach library has been replaced with a maintained alternative.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 13, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1286"]}, "title": "Weak hashing in storage backends", "description": "The use of MD5 hashes in the asynchronous reconcile_file_storage task can lead to confusion during reconciliation between S3 and Backblaze B2 object storage, allowing an attacker to induce confusion and persist maliciously injected objects.", "severity": "N/A", "contract": "GenericS3BlobStorage", "function": "get_checksum", "lineNumber": "221-230"}, {"id": 14, "category": {"1": ["CWE-703"]}, "title": "Uncaught exception with crafted README", "description": "Warehouse uses `readme_renderer` to generate HTML from user-supplied project metadata. A `docutils` bug causes an unhandled `IndexError` while handling specially crafted inputs.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 15, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "ReDoS via zxcvbn-python dependency", "description": "The audit report highlights a ReDoS vulnerability due to the use of the zxcvbn-python dependency.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 16, "category": {"1": ["CWE-707"], "2": ["CWE-74"], "3": ["CWE-77"], "4": ["CWE-78"]}, "title": "Use of shell=True in subprocesses", "description": "Invocation of subprocess.run with shell=True allows an attacker to inject unintended commands into the executed sequence due to user-controlled inputs during argument construction.", "severity": "Critical", "contract": "cabotage-app/cabotage/celery/tasks/build.py", "function": "N/A", "lineNumber": "314-319, 658-663"}]}