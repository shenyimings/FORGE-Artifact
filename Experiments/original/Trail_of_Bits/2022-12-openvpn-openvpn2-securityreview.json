{"path": "./Audit_Reports_2024/Trail_of_Bits/2022-12-openvpn-openvpn2-securityreview.pdf", "project_info": {"url": "N/A", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "Broken fuzzing harnesses", "description": "OpenVPN fuzzing is performed through the oss-fuzz project; however, the build has been broken since November 8, 2022, and the code has not been continuously fuzzed via oss-fuzz since that time.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-664"], "2": ["CWE-404"], "3": ["CWE-772"], "4": ["CWE-401"]}, "title": "Certain error paths do not free allocated memory leading to memory leaks", "description": "Memory leak occurs due to lack of freeing allocated resources in certain error paths.", "severity": "High", "contract": "N/A", "function": ["verify_user_pass_script", "get_console_input_systemd", "set_lladdr"], "lineNumber": ["N/A"]}, {"id": 2, "category": {"1": ["CWE-707"], "2": ["CWE-170"]}, "title": "Stack buffer out-of-bounds read in command line options parsing", "description": "An out-of-bounds read occurs in string_array_len when parsing command line options due to a stack buffer overflow.", "severity": "Informational", "contract": "N/A", "function": "parse_argv and string_array_len", "lineNumber": "L5322-L5355"}, {"id": 3, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1173"]}, "title": "Support of weak proxy authentication algorithm", "description": "The code supports outdated, weak protocols and algorithms for proxy authentication, such as NTLMv1 and DES.", "severity": "Moderate", "contract": "OpenVPN2", "function": "N/A", "lineNumber": "24"}, {"id": 4, "category": {"1": ["CWE-707"], "2": ["CWE-170"]}, "title": "Decoding username can silently cause truncated or empty username", "description": "The misuse of USER_PASS_LEN constant can lead to strcpy overflowing the pi.up.username buffer, causing a truncated or empty username.", "severity": "High", "contract": "N/A", "function": "LLVMFuzzerTestOneInput", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-693"], "2": ["CWE-311"], "3": ["CWE-319"]}, "title": "Lack of TLS support by the HTTP and SOCKS proxy may lead to compromise of a user's proxy authentication credentials", "description": "OpenVPN does not implement TLS for proxy authentication traffic, leaving the traffic and the credentials contained in the traffic vulnerable to disclosure and manipulation attacks.", "severity": "Moderate", "contract": "OpenVPN2", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "Implicit conversions that lose integer precision", "description": "The code contains many cases where variables of the integer class are implicitly converted from one type to another in a way that risks altering the value.", "severity": "Undetermined", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "The OpenVPN build system does not enable compiler security mitigations", "description": "The OpenVPN build system on Linux does not explicitly enable modern compiler security mitigations, which may cause users to use less secure configurations if they build the OpenVPN binaries themselves without extra caution.", "severity": "Undetermined", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-354"]}, "title": "The ntlm_phase_3 function does not verify if it received the correct length of the challenge data", "description": "The `ntlm_phase_3` code does not verify that the length of the decoded buffer matches the expected length of the challenge data, which is eight bytes.", "severity": "Undetermined", "contract": "openvpn", "function": "ntlm_phase_3", "lineNumber": "256-269"}, {"id": 9, "category": {"1": ["CWE-703"], "2": ["CWE-228"], "3": ["CWE-237"], "4": ["CWE-239"]}, "title": "The establish_http_proxy_passthru function proxy-authenticate header check is insufficient", "description": "The function does not properly handle the Proxy-Authenticate header and does not account for duplicated headers, potentially leading to incorrect request processing.", "severity": "Undetermined", "contract": "N/A", "function": "establish_http_proxy_passthru()", "lineNumber": "N/A"}]}