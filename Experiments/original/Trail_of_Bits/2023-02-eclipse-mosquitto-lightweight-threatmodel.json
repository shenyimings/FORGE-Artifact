{"path": "./Audit_Reports_2024/Trail_of_Bits/2023-02-eclipse-mosquitto-lightweight-threatmodel.pdf", "project_info": {"url": "N/A", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-284"]}, "title": "Insufficient default configuration file permissions", "description": "The broker does not have sufficient strict access permissions for local configuration files, which can lead to unintentional running with no usernames and passwords if permissions are too open.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-863"]}, "title": "Unclear ACL, role, group enforcement priority", "description": "The acl_check() structure does not clearly define the precedence ordering of user and group-associated rules, leading to potential security issues.", "severity": "Medium", "contract": "N/A", "function": "acl_check()", "lineNumber": "L218"}, {"id": 2, "category": {"1": ["CWE-664"], "2": ["CWE-400"], "3": ["CWE-770"]}, "title": "Missing global connection rate limiting", "description": "Mosquitto lacks broker-wide (global) rate-limiting mechanisms for connection and authentication attempts, which could lead to resource overuse by a particular client or bridge.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "Plaintext password storage and handling", "description": "The Mosquitto ctrl utilities and broker permit plaintext password storage and usage.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-435"]}, "title": "Bridge -> broker -> bridge message looping", "description": "An attacker can create a loop between two brokers by bridging and subscribing to topics, causing infinite loops and over-consuming system resources.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-284"]}, "title": "Broker does not check configuration filesystem permissions", "description": "Mosquitto broker settings can come from local user-managed files such as mosquitto.conf. On a system with Linux capabilities, any user with CAP_KILL capabilities for the broker parent process can force the broker to reload all configuration files by sending the SIGHUP signal to the broker process via kill().", "severity": "High", "contract": "Mosquitto Broker", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-691"]}, "title": "Configuration reload may cause inconsistent behavior", "description": "The Mosquitto broker reloads its configuration upon receiving a SIGHUP signal. If settings that affect how requests are handled are changed, requests that are received during the configuration reload could be processed in unexpected or inconsistent ways.", "severity": "Low", "contract": "Mosquitto Broker", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-732"]}, "title": "Clients can publish last will messages to $CONTROL topics", "description": "Prevent all clients from setting any $CONTROL topic as the destination topic for an LWT.", "severity": "Medium", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}]}