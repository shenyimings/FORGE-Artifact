{"path": "./Audit_Reports_2024/Trail_of_Bits/2022-12-curl-securityreview.pdf", "project_info": {"url": "N/A", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "Bad recommendation in libcurl cookie documentation", "description": "The libcurl documentation recommends using a non-existing file name or plain \"\" to enable the cookie store with a blank cookie database, but this can have unexpected results if a file by that name is unexpectedly present.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 1, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "Libcurl URI parser accepts invalid characters", "description": "The Libcurl URI parser does not properly validate input according to RFC 3986 section 2.2, allowing reserved characters in URIs.", "severity": "Undetermined", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "libcurl Alt-Svc parser accepts invalid port numbers", "description": "Invalid port numbers in `Alt-Svc` headers, such as negative numbers, may be accepted by libcurl when presented by an HTTP server.", "severity": "Undetermined", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-697"], "2": ["CWE-1254"]}, "title": "Non-constant-time comparison of secrets", "description": "N/A", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-707"], "2": ["CWE-74"]}, "title": "Tab injection in cookie file", "description": "cURL does not reject cookies with tabs inside keys or values, allowing tab injection in cookie files when parsing tab-separated cookie data via strtok_r().", "severity": "High", "contract": "N/A", "function": "Curl_cookie_add()", "lineNumber": "N/A"}, {"id": 5, "category": {"1": ["CWE-664"], "2": ["CWE-404"], "3": ["CWE-772"], "4": ["CWE-775"]}, "title": "Standard output/input/error may not be opened", "description": "stdin/out/err being redirected to an unexpected location if the maximum number of handles has been reached at the time of this check, but handles are closed between it and the next attempt to create a socket.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "tool_main.c:83\u2013105"}, {"id": 6, "category": {"1": ["CWE-703"], "2": ["CWE-754"], "3": ["CWE-391"]}, "title": "Double free when using HTTP proxy with specific protocols", "description": "A double free occurs during connection cleanup when cURL (or libcurl) makes a connection through a proxy.", "severity": "Critical", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-693"], "2": ["CWE-807"]}, "title": "Some flags override previous instances of themselves", "description": "The `--crlfile` command-line option allows users to pass a PEM-formatted certificate revocation list to cURL. If this option is used several times, the last one will be used.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-284"], "2": ["CWE-923"], "3": ["CWE-300"]}, "title": "Cookies are not stripped after redirect", "description": "Cookies should be stripped during a redirect to prevent potential security issues, especially when the origin changes.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-664"], "2": ["CWE-404"], "3": ["CWE-772"], "4": ["CWE-401"]}, "title": "Use after free while using parallel option and sequences", "description": "The 'add_parallel_transfers' function has a use-after-free vulnerability when freeing the 'errorbuf' memory, which can cause heap-use-after-free errors.", "severity": "Critical", "contract": "N/A", "function": "add_parallel_transfers", "lineNumber": "2228-2253"}, {"id": 10, "category": {"1": ["CWE-664"], "2": ["CWE-404"], "3": ["CWE-772"], "4": ["CWE-401"]}, "title": "Unused memory blocks are not freed resulting in memory leaks", "description": "Memory leaks occur when unused memory blocks are not freed.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 11, "category": {"1": ["CWE-707"], "2": ["CWE-116"], "3": ["CWE-838"]}, "title": "Referer header is generated in insecure manner", "description": "The cURL automatically sets the `referer` header for HTTP redirects when provided with the `--referer \u2018;auto\u2019` flag. The header set contains the entire original URL except for the user-password fragment, which is against current best practices.", "severity": "Low", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 12, "category": {"1": ["CWE-707"], "2": ["CWE-74"], "3": ["CWE-99"]}, "title": "Redirect to localhost and local network is possible (Server-side request forgery like)", "description": "When redirects are enabled with cURL, a server may redirect a request to an arbitrary endpoint, giving requested servers partial access to cURL\u2019s users local networks.", "severity": "Informational", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 13, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "URL parsing from redirect is incorrect when no path separator is provided", "description": "The URL parsing mechanism fails to correctly handle redirects without a path separator, potentially leading to security issues.", "severity": "High", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}]}