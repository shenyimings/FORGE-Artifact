{"path": "./Audit_Reports_2024/Trail_of_Bits/SpruceID.pdf", "project_info": {"url": "https://github.com/tzprofiles", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-703"], "2": ["CWE-228"], "3": ["CWE-229"], "4": ["CWE-230"]}, "title": "The Tezos DID resolver accepts invalid input that can crash the program", "description": "The Tezos DID resolver does not sufficiently validate data and accepts input that will cause a panic.", "severity": "High", "contract": "SSI", "function": "resolve", "lineNumber": "84"}, {"id": 1, "category": {"1": ["CWE-703"]}, "title": "The program can crash when parsing EIP-712 types", "description": "The implementation of the `TryFrom` trait for the `EIP712Type` calls `unwrap` multiple times, which could lead to a panic on maliciously crafted input.", "severity": "High", "contract": "N/A", "function": "try_from", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-707"], "2": ["CWE-20"], "3": ["CWE-1287"]}, "title": "Finding 3: Potentially unsafe dependency on the internal representation of types from the bbs crate", "description": "The implementation of `From<SecretKey>` for `BlsSecretKey` uses `std::mem::transmute` to convert the internal representation of a `bbs` crate `SecretKey` to a `BlsSecretKey`, which may lead to silent breaking of the implementation if the internal representation used by this crate changes.", "severity": "Informational", "contract": "ssi/src/bbs.rs", "function": "impl From<SecretKey> for BlsSecretKey", "lineNumber": "N/A"}, {"id": 3, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Potential panic when creating a new BLS key pair", "description": "Passing an invalid blinding value to `BlsKeyPair::new` causes the implementation to panic.", "severity": "Informational", "contract": "ssi/src/bbs.rs", "function": "bls_generate_keypair", "lineNumber": "N/A"}, {"id": 4, "category": {"1": ["CWE-707"], "2": ["CWE-20"]}, "title": "Tezos DID resolver does not take the network into account", "description": "The Tezos DID resolver uses a hardcoded mainnet API URL rather than considering the Tezos network associated with the DID.", "severity": "Undetermined", "contract": "did-tezos", "function": "N/A", "lineNumber": "L35-41"}, {"id": 5, "category": {"1": ["CWE-682"], "2": ["CWE-193"]}, "title": "PassthroughDigest reduces the entropy of the output for digests that are not 32 bytes", "description": "The PassthroughDigest::update function stores input in the value field if the input size is exactly 32 bytes, otherwise it reduces the entropy of the output by storing either the first byte of the input repeated 32 times or 0 repeated 32 times.", "severity": "Informational", "contract": "ssi/src/passthrough_digest.rs", "function": "update", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-710"], "2": ["CWE-1041"]}, "title": "The Tezos Profiles contract code is duplicated", "description": "The Michelson version of the Tezos Profiles contract is duplicated in two places: in a file in the same directory as the ReLIGO version and as a string in the TypeScript code under `tzprofiles/contract/lib/contract.ts`.", "severity": "Informational", "contract": "Tezos Profiles", "function": "N/A", "lineNumber": "N/A"}]}