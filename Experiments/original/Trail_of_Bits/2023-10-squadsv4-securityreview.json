{
    "path": "./Audit_Reports_2024/Trail_of_Bits/2023-10-squadsv4-securityreview.pdf",
    "project_info": {
        "url": "https://github.com/Squads-Protocol/v4",
        "commit_hash": "e5dfcee142c16d9255c92157d092d79568179b197d79e69c03892be468cce8acb51b6748b6262fbb",
        "address": "N/A",
        "is_exists": true
    },
    "findings": [
        {
            "id": 0,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ]
            },
            "title": "Reliance on vulnerable dependencies",
            "description": "The smart contract relies on dependencies with known vulnerabilities, which could have a significant effect on the system as a whole.",
            "severity": "Undetermined",
            "contract": "Cargo.lock",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 1,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-229"
                ],
                "4": [
                    "CWE-230"
                ]
            },
            "title": "2. Insufficient linter use",
            "description": "The codebase lacks proper linting which might have caught bugs if enabled. Review and address warnings generated by Clippy\u2019s default lints and enable pedantic lints for additional suggestions.",
            "severity": "Informational",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 2,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-228"
                ],
                "3": [
                    "CWE-229"
                ],
                "4": [
                    "CWE-230"
                ]
            },
            "title": "3. Lack of build instructions",
            "description": "The project's README does not contain sufficient information for building and running tests.",
            "severity": "Medium",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 3,
            "category": {
                "1": [
                    "CWE-691"
                ],
                "2": [
                    "CWE-841"
                ]
            },
            "title": "Functions invariant and invalidate_prior_transactions called in wrong order",
            "description": "The functions invariant and invalidate_prior_transactions are called in the wrong order, which can lead to incorrect behavior.",
            "severity": "High",
            "contract": "MultisigConfig",
            "function": "multisig_add_member",
            "lineNumber": "108-110, 139-141, 159-161, 176-178, 196-198"
        },
        {
            "id": 4,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Insufficient test coverage",
            "description": "The audit report highlights the limitations of test coverage due to time constraints and lack of fuzzing.",
            "severity": "Medium",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 5,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ],
                "3": [
                    "CWE-391"
                ]
            },
            "title": "Insufficient logging",
            "description": "N/A",
            "severity": "Informational",
            "contract": "N/A",
            "function": "N/A",
            "lineNumber": "N/A"
        },
        {
            "id": 6,
            "category": {
                "1": [
                    "CWE-284"
                ],
                "2": [
                    "CWE-285"
                ],
                "3": [
                    "CWE-863"
                ]
            },
            "title": "Attacker can front-run multisig creation transaction",
            "description": "An attacker can front-run a user\u2019s multisig creation transaction and create the multisig with their own parameters, allowing them to perform transactions from that multisig.",
            "severity": "High",
            "contract": "squads_multisig_program",
            "function": "multisig_create",
            "lineNumber": "N/A"
        },
        {
            "id": 7,
            "category": {
                "1": [
                    "CWE-707"
                ],
                "2": [
                    "CWE-20"
                ],
                "3": [
                    "CWE-1287"
                ]
            },
            "title": "Program uses same set of ephemeral keys for all transactions in a batch",
            "description": "The program derives ephemeral keys from the batch transaction's account key, resulting in the same ephemeral keys being used for all transactions in that batch.",
            "severity": "Unresolved",
            "contract": "N/A",
            "function": "batch_add_transaction",
            "lineNumber": "117-128"
        },
        {
            "id": 8,
            "category": {
                "1": [
                    "CWE-682"
                ]
            },
            "title": "Inefficient lookup table account verification during transaction execution",
            "description": "The program does not strictly verify that lookup table accounts given at the time of execution exactly match with the accounts given at the time of transaction initialization, resulting in unnecessary on-chain computation and wasted gas.",
            "severity": "Informational",
            "contract": "squads_multisig_program",
            "function": "ExecutableTransactionMessage::new_validated",
            "lineNumber": "28-62"
        },
        {
            "id": 9,
            "category": {
                "1": [
                    "CWE-703"
                ],
                "2": [
                    "CWE-754"
                ]
            },
            "title": "Unverified Length of preBalances",
            "description": "Add a check to verify the length of preBalances in batch-sol-transfer.ts to improve test robustness.",
            "severity": "Low",
            "contract": "batch-sol-transfer",
            "function": "N/A",
            "lineNumber": "226-231"
        }
    ]
}