{"path": "./Audit_Reports_2024/Trail_of_Bits/2023-03-eclipse-jetty-securityreview.pdf", "project_info": {"url": "N/A", "commit_hash": "N/A", "address": "N/A"}, "findings": [{"id": 0, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "Risk of integer overflow that could allow HpackDecoder to exceed maxHeaderSize", "description": "An integer overflow could occur in the `MetaDataBuilder.checkSize` function, which would allow HPACK header values to exceed their size limit.", "severity": "Medium", "contract": "org.eclipse.jetty.http2.hpack.internal.MetaDataBuilder, org.eclipse.jetty.http2.hpack.HpackDecoder", "function": "checkSize", "lineNumber": "291-298"}, {"id": 1, "category": {"1": ["CWE-707"], "2": ["CWE-138"], "3": ["CWE-150"]}, "title": "Cookie parser accepts unmatched quotation marks", "description": "The RFC6265CookieParser.parseField function does not check for unmatched quotation marks.", "severity": "Informational", "contract": "org.eclipse.jetty.http.RFC6265CookieParser", "function": "parseField", "lineNumber": "N/A"}, {"id": 2, "category": {"1": ["CWE-707"], "2": ["CWE-74"], "3": ["CWE-77"], "4": ["CWE-88"]}, "title": "Errant command quoting in CGI servlet", "description": "Incorrect quotation marks around filename in CGI servlet allows an attacker to bypass alias checks and cause unintended behaviors.", "severity": "High", "contract": "CGI.java", "function": "N/A", "lineNumber": "337-338, 346"}, {"id": 3, "category": {"1": ["CWE-284"], "2": ["CWE-285"], "3": ["CWE-863"]}, "title": "Symlink-allowed alias checker ignores protected targets list", "description": "The SymlinkAllowedResourceAliasChecker class permits users to access a symlink as long as it is stored within an allowed directory but does not enforce the context handler's protected resource list, allowing attackers to bypass the protected resource list and access sensitive files.", "severity": "High", "contract": "org.eclipse.jetty.server.SymlinkAllowedResourceAliasChecker", "function": "N/A", "lineNumber": "76"}, {"id": 4, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Missing check for malformed Unicode escape sequences in QuotedStringTokenizer.unquote", "description": "The `QuotedStringTokenizer` class\u2019s `unquote` method parses Unicode escape sequences but does not first check that the escape sequence is properly formatted or that the string is of a sufficient length, leading to potential exceptions.", "severity": "Low", "contract": "org.eclipse.jetty.util.QuotedStringTokenizer", "function": "unquote", "lineNumber": "L547\u2013L555"}, {"id": 5, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "WebSocket frame length represented with 32-bit integer", "description": "The WebSocket parser represents the frame length with a 32-bit integer, which can lead to potential issues as it does not comply with the WebSocket standard (RFC 6455) that allows for frames with a size of up to 2^64 bytes.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 6, "category": {"1": ["CWE-682"], "2": ["CWE-191"]}, "title": "WebSocket parser does not check for negative payload lengths", "description": "The WebSocket parser does not check for negative payload lengths, which can lead to potential security issues.", "severity": "Critical", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 7, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "WebSocket parser greedily allocates ByteBuffers for large frames", "description": "The WebSocket parser allocates entire buffers as soon as it parses the first fragment, which can lead to RAM consumption by an attacker sending a large amount of bytes over the wire.", "severity": "N/A", "contract": "N/A", "function": "N/A", "lineNumber": "N/A"}, {"id": 8, "category": {"1": ["CWE-682"], "2": ["CWE-190"]}, "title": "Risk of integer overflow in HPACK's NBitInteger.decode", "description": "N/A", "severity": "Informational", "contract": "N/A", "function": "NBitInteger.decode", "lineNumber": "N/A"}, {"id": 9, "category": {"1": ["CWE-682"], "2": ["CWE-191"]}, "title": "MetaDataBuilder.checkSize accepts headers of negative lengths", "description": "The MetaDataBuilder.checkSize function accepts user-entered HPACK header values of negative sizes, which could cause a very large buffer to be allocated later when the user-entered size is multiplied by 2.", "severity": "Critical", "contract": "org.eclipse.jetty.http2.hpack.internal.MetaDataBuilder", "function": "checkSize(int length, boolean huffman)", "lineNumber": "295-296"}, {"id": 10, "category": {"1": ["CWE-703"], "2": ["CWE-754"]}, "title": "Insufficient space allocated when encoding QPACK instructions and entries", "description": "Multiple expressions do not allocate enough buffer space when encoding QPACK instructions and entries, which could result in a buffer overflow exception.", "severity": "Low", "contract": "org.eclipse.jetty.http3.qpack.internal.instruction.IndexedNameEntryInstruction, org.eclipse.jetty.http3.qpack.internal.instruction.LiteralNameEntryInstruction, org.eclipse.jetty.http3.qpack.internal.instruction.EncodableEntry", "function": "N/A", "lineNumber": "78-89"}]}